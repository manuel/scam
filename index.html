<html>
<head>
  <title>scam</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
  <script type="text/javascript" src="../wat-js/wat.js"></script>
  <script type="text/javascript" src="../wat-js/wat-basics.js"></script>
  <style>
    html { font-family: sans; }
    .box {
        margin: 0 .2em .2em; padding: 0 .2em; display: inline-table;
        border-bottom: 1px solid gray;
        border-left: 0.5em solid gray; 
        border-radius: 1em;
    }
    .line { display: table-row; margin-bottom: 1em; }
    .text { display: inline; margin: 0 .25em;}
    .h { font-weight: bold; }
  </style>
</head>
<body>
<h1><a href="https://github.com/manuel/scam">scam</a></h1>
<script type="text/javascript">
var code = 
    ["begin",
     wat_basics.main,
     ["define-macro", ["text", "str"],
      ["list", "make-text", ["list", "string", "str"]]],
     ["define", ["make-text", "str"],
      ["let", [["div", ["#", "createElement", document, ["string", "div"]]]],
       ["#", "setAttribute", "div", ["string", "class"], ["string", "text"]],
       ["#", "appendChild", "div", ["#", "createTextNode", document, "str"]],
       "div"]],
     ["define-macro", ["h", "str"],
      ["list", "make-h", ["list", "string", "str"]]],
     ["define", ["make-h", "str"],
      ["let", [["div", ["#", "createElement", document, ["string", "div"]]]],
       ["#", "setAttribute", "div", ["string", "class"], ["string", "h"]],
       ["#", "appendChild", "div", ["#", "createTextNode", document, "str"]],
       "div"]],
     ["define", ["box", "#rest", "elts"],
      ["let", [["div", ["#", "createElement", document, ["string", "div"]]]],
       ["#", "setAttribute", "div", ["string", "class"], ["string", "box"]],
       ["map-list", ["lambda", ["elt"], ["#", "appendChild", "div", "elt"]], "elts"],
       "div"]],
     ["define", ["line", "#rest", "elts"],
      ["let", [["div", ["#", "createElement", document, ["string", "div"]]]],
       ["#", "setAttribute", "div", ["string", "class"], ["string", "line"]],
       ["if", ["nil?", "elts"],
        ["js-set-element", "div", ["string", "innerHTML"], ["string", "&nbsp;"]],
        ["map-list", ["lambda", ["elt"], ["#", "appendChild", "div", "elt"]], "elts"]],
       "div"]],

     ["define", "LET-SAMPLE",
      ["box",
       ["line",
        ["box",
         ["line",
          ["text", "let"],
          ["box", ["line",
                   ["box", ["line", ["text", "x"], ["text", "1"]]],
                   ["box", ["line", ["text", "y"], ["text", "2"]]]]]],
         ["line",
          ["box", ["line", ["text", "+"], ["text", "x"], ["text", "y"]]]]]],
       ["line",
        ["box",
         ["line",
          ["h", "Hello world!"]],
         ["line",
          ["text", "This is a sample document."]]]]]],
     ["#", "appendChild", [".", "body", document], "LET-SAMPLE"],

    ];
console.log(new wat.VM().run(code));
</script>
</body>
</html>
